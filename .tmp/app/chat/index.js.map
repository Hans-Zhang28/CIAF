{"version":3,"sources":["../../../client/app/chat/index.js"],"names":[],"mappings":";;;AACA,IAAI,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;AACjC,IAAI,GAAG,GAAG,OAAO,EAAE,CAAC;AACpB,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;AAC/C,IAAI,EAAE,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC;AAClC,IAAI,IAAI,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC;;AAEpC,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,YAAY;AAC9B,SAAO,CAAC,GAAG,CAAC,6BAA6B,EAAE,IAAI,CAAC,CAAC;CAClD,CAAC,CAAC;;;AAGH,GAAG,CAAC,GAAG,CAAC,OAAO,UAAO,CAAC,SAAS,GAAG,SAAS,CAAC,CAAC,CAAC;;;;;AAK/C,IAAI,SAAS,GAAG,EAAE,CAAC;AACnB,IAAI,QAAQ,GAAG,CAAC,CAAC;;AAEjB,EAAE,CAAC,EAAE,CAAC,YAAY,EAAE,UAAU,MAAM,EAAE;AACpC,MAAI,SAAS,GAAG,KAAK,CAAC;;;AAGtB,QAAM,CAAC,EAAE,CAAC,aAAa,EAAE,UAAU,IAAI,EAAE;;AAEvC,UAAM,CAAC,SAAS,CAAC,IAAI,CAAC,aAAa,EAAE;AACnC,cAAQ,EAAE,MAAM,CAAC,QAAQ;AACzB,aAAO,EAAE,IAAI;KACd,CAAC,CAAC;GACJ,CAAC,CAAC;;;AAGH,QAAM,CAAC,EAAE,CAAC,UAAU,EAAE,UAAU,QAAQ,EAAE;;AAExC,UAAM,CAAC,QAAQ,GAAG,QAAQ,CAAC;;AAE3B,aAAS,CAAC,QAAQ,CAAC,GAAG,QAAQ,CAAC;AAC/B,MAAE,QAAQ,CAAC;AACX,aAAS,GAAG,IAAI,CAAC;AACjB,UAAM,CAAC,IAAI,CAAC,OAAO,EAAE;AACnB,cAAQ,EAAE,QAAQ;KACnB,CAAC,CAAC;;AAEH,UAAM,CAAC,SAAS,CAAC,IAAI,CAAC,aAAa,EAAE;AACnC,cAAQ,EAAE,MAAM,CAAC,QAAQ;AACzB,cAAQ,EAAE,QAAQ;KACnB,CAAC,CAAC;GACJ,CAAC,CAAC;;;AAGH,QAAM,CAAC,EAAE,CAAC,QAAQ,EAAE,YAAY;AAC9B,UAAM,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,EAAE;AAC9B,cAAQ,EAAE,MAAM,CAAC,QAAQ;KAC1B,CAAC,CAAC;GACJ,CAAC,CAAC;;;AAGH,QAAM,CAAC,EAAE,CAAC,aAAa,EAAE,YAAY;AACnC,UAAM,CAAC,SAAS,CAAC,IAAI,CAAC,aAAa,EAAE;AACnC,cAAQ,EAAE,MAAM,CAAC,QAAQ;KAC1B,CAAC,CAAC;GACJ,CAAC,CAAC;;;AAGH,QAAM,CAAC,EAAE,CAAC,YAAY,EAAE,YAAY;;AAElC,QAAI,SAAS,EAAE;AACb,aAAO,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AAClC,QAAE,QAAQ,CAAC;;;AAGX,YAAM,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,EAAE;AACjC,gBAAQ,EAAE,MAAM,CAAC,QAAQ;AACzB,gBAAQ,EAAE,QAAQ;OACnB,CAAC,CAAC;KACJ;GACF,CAAC,CAAC;CACJ,CAAC,CAAC","file":"index.js","sourcesContent":["// Setup basic express server\nvar express = require('express');\nvar app = express();\nvar server = require('http').createServer(app);\nvar io = require('../..')(server);\nvar port = process.env.PORT || 3000;\n\nserver.listen(port, function () {\n  console.log('Server listening at port %d', port);\n});\n\n// Routing\napp.use(express.static(__dirname + '/public'));\n\n// Chatroom\n\n// usernames which are currently connected to the chat\nvar usernames = {};\nvar numUsers = 0;\n\nio.on('connection', function (socket) {\n  var addedUser = false;\n\n  // when the client emits 'new message', this listens and executes\n  socket.on('new message', function (data) {\n    // we tell the client to execute 'new message'\n    socket.broadcast.emit('new message', {\n      username: socket.username,\n      message: data\n    });\n  });\n\n  // when the client emits 'add user', this listens and executes\n  socket.on('add user', function (username) {\n    // we store the username in the socket session for this client\n    socket.username = username;\n    // add the client's username to the global list\n    usernames[username] = username;\n    ++numUsers;\n    addedUser = true;\n    socket.emit('login', {\n      numUsers: numUsers\n    });\n    // echo globally (all clients) that a person has connected\n    socket.broadcast.emit('user joined', {\n      username: socket.username,\n      numUsers: numUsers\n    });\n  });\n\n  // when the client emits 'typing', we broadcast it to others\n  socket.on('typing', function () {\n    socket.broadcast.emit('typing', {\n      username: socket.username\n    });\n  });\n\n  // when the client emits 'stop typing', we broadcast it to others\n  socket.on('stop typing', function () {\n    socket.broadcast.emit('stop typing', {\n      username: socket.username\n    });\n  });\n\n  // when the user disconnects.. perform this\n  socket.on('disconnect', function () {\n    // remove the username from global usernames list\n    if (addedUser) {\n      delete usernames[socket.username];\n      --numUsers;\n\n      // echo globally that this client has left\n      socket.broadcast.emit('user left', {\n        username: socket.username,\n        numUsers: numUsers\n      });\n    }\n  });\n});\n"]}